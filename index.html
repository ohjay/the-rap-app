<!DOCTYPE html>
<html lang="en">
<head>
    <title>The Rap App</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <p>Hey, welcome to the Rap App! I'm just testing out some speech recognition stuff right now.</p>
    <div id="log"></div>
    <div id="final-word"></div>
    
    <!-- Scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>
        var newSpeechRecognition = function() {
            var r = new webkitSpeechRecognition();
            r.interimResults = true;
            // r.continuous = true;
            
            r.onresult = function(event) {
                /* Only the final word */
                if (event.results[event.results.length - 1].isFinal) {
                    document.getElementById("final-word").innerHTML 
                            = "Final phrase: " + event.results[event.results.length - 1][0].transcript;
                    r.stop();
                }
                
                /* All words:
                var final_transcript = '';
                var interim_transcript = '';
                
                for (var i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        final_transcript += event.results[i][0].transcript;
                        r.stop();
                    } else {
                        interim_transcript += event.results[i][0].transcript;
                    }
                }
            
                document.getElementById("final-transcript").innerHTML = final_transcript;
                document.getElementById("interim-transcript").innerHTML = interim_transcript; */
            };
            
            r.onerror = function(event) {
                $('#log').text('[ERROR] Might want to check that.');
            };
            
            r.onend = function() { 
                $('#log').text('It\'s over! It\'s all over!');
                recognition = newSpeechRecognition();
                recognition.start();
            };
            
            return r;
        }
        
        var recognition = newSpeechRecognition();
        recognition.start();
    </script>
</body>
</html>
